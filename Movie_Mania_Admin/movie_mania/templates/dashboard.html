{% extends "base.html" %}
{% block content %}

<h1>Dashboard</h1>

<div class="stats">
    <div class="card">Total Movies <span id="movies"></span></div>
    <div class="card">Total Shows <span id="shows"></span></div>
    <div class="card">Total Users <span id="users"></span></div>
    <div class="card">Total Revenue <span id="revenue"></span></div>
</div>

<h3>Recent Uploads</h3>
<table>
<thead>
<tr><th>Title</th><th>Views</th></tr>
</thead>
<tbody id="recent"></tbody>
</table>

<script>
authFetch("/api/dashboard/").then(data => {
    document.getElementById("movies").innerText = data.total_movies;
    document.getElementById("shows").innerText = data.total_shows;
    document.getElementById("users").innerText = data.total_users;
    document.getElementById("revenue").innerText = "â‚¹" + data.total_revenue;

    let html = "";
    data.recent_uploads.forEach(m => {
        html += `<tr><td>${m.title}</td><td>${m.views}</td></tr>`;
    });
    document.getElementById("recent").innerHTML = html;
});
</script>

{% endblock %}
